(()=>{var a;!function(a){a.LOAD="LOAD",a.EXEC="EXEC",a.WRITE_FILE="WRITE_FILE",a.READ_FILE="READ_FILE",a.ERROR="ERROR",a.DOWNLOAD="DOWNLOAD",a.PROGRESS="PROGRESS",a.LOG="LOG"}(a||(a={}));const e=new Error("unknown message type"),t=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),r=new Error("called FFmpeg.terminate()");let s;const n=async({coreURL:e,wasmURL:t,workerURL:r})=>{const n=!s;importScripts(e);const o=e,c=t||e.replace(/.js$/g,".wasm"),i=r||e.replace(/.js$/g,".worker.js");return s=await createFFmpegCore({mainScriptUrlOrBlob:`${o}#${btoa(JSON.stringify({wasmURL:c,workerURL:i}))}`}),s.setLogger((e=>self.postMessage({type:a.LOG,data:e}))),s.setProgress((e=>self.postMessage({type:a.PROGRESS,data:e}))),n},o=({args:a,timeout:e=-1})=>{s.setTimeout(e),s.exec(...a);const t=s.ret;return s.reset(),t},c=({path:a,data:e})=>(s.FS.writeFile(a,e),!0),i=({path:a,encoding:e})=>s.FS.readFile(a,{encoding:e});self.onmessage=async({data:{id:r,type:d,data:l}})=>{const w=[];let p;try{if(d!==a.LOAD&&!s)throw t;switch(d){case a.LOAD:p=await n(l);break;case a.EXEC:p=o(l);break;case a.WRITE_FILE:p=c(l);break;case a.READ_FILE:p=i(l);break;default:throw e}}catch(e){return void self.postMessage({id:r,type:a.ERROR,data:e.toString()})}p instanceof Uint8Array&&w.push(p.buffer),self.postMessage({id:r,type:d,data:p},w)}})();