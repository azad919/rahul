(()=>{var t={209:(t,e,n)=>{const r=n(932),o=n(27).default;t.exports=function(){return{u:{},_(t,e,n){if(!n||!n.parsedInfo)return;this.u[e]||=[];const i=n.parsedInfo.qualities?n.parsedInfo.qualities:n.parsedInfo,s=n.type,c=i[0]?.m3u?.masterUrl||t,a=void 0;if(this.u[e].some((t=>t.qualities[0]?.m3u?.masterUrl===c||t.qualities[0]?.fileUrl===c))&&"masterM3U"===s)return;const u=new r({title:n.parsedInfo.title||null,tabId:e,qualities:i,type:s,duration:n.parsedInfo.duration||null});try{if("playlist"===s){const t=this.h(u);if(t&&this.T(t,u))return}"masterM3U"===s&&this.v(u),this.u[e].push(u),o.I({tabId:e,videoCount:this.u[e].length||0})}catch(t){}},h(t){const e=this.u[t.tabId]||[],n=this.$(t.qualities[0]?.fileUrl);if(!n)return null;for(const t of e){if("masterM3U"!==t.type)continue;const e=void 0;if(t.qualities.map((t=>this.$(t.fileUrl))).includes(n))return t}return null},T(t,e){const n=e.qualities[0],r=this.$(n.fileUrl),o=t.qualities.findIndex((t=>this.$(t.fileUrl)===r));if(o<0)return!1;const i=t.qualities[o];return n.m3u&&(i.m3u=i.m3u||{},Array.isArray(n.m3u.videoLinks)&&n.m3u.videoLinks.length&&(i.m3u.videoLinks=n.m3u.videoLinks.slice()),Array.isArray(n.m3u.audioLinks)&&n.m3u.audioLinks.length&&(i.m3u.audioLinks=n.m3u.audioLinks.slice()),n.m3u.masterUrl&&!i.m3u.masterUrl&&(i.m3u.masterUrl=n.m3u.masterUrl)),n.fileSize&&!i.fileSize&&(i.fileSize=n.fileSize),e.duration&&!t.duration&&(t.duration=e.duration),!0},S(t){for(const e of this.u[t.tabId]||[]){if("master"!==e.type)continue;const n=e.qualities.map((t=>t.fileUrl)),r=t.qualities[0]?.fileUrl;if(r&&n.includes(r))return!0}return!1},$(t){if(!t)return"";try{const e=new URL(t.trim());return`${e.origin}${e.pathname}${e.search}${e.hash}`.toLowerCase()}catch{return t.trim().toLowerCase()}},v(t){const e=t.tabId,n=this.u[e]||[],r=t.qualities.map((t=>this.$(t.fileUrl)));for(const e of n){if("playlist"!==e.type)continue;const n=this.$(e.qualities[0]?.fileUrl);n&&r.includes(n)&&this.T(t,e)}this.u[e]=n.filter((t=>{if("playlist"!==t.type)return!0;const e=this.$(t.qualities[0]?.fileUrl);return!(e&&r.includes(e))}))},A(t,e){return!!this.u[e]&&this.u[e].some((e=>e.qualities.some((e=>e.m3u&&e.m3u.masterUrl===t))))},M(t){return t&&t.tabId?this.u[t.tabId]||[]:null},N(t,e){if(!t||!this.u[e])return!1;for(const n of this.u[e])if(n.qualities)for(const e of n.qualities)if(e&&e.src&&e.src===t)return!0;return!1},k(t,e,n=!0){if(!this.u[t])return!1;for(const r of this.u[t])if(r.qualities)for(const t of r.qualities)if(t&&t.fileUrl===e)return r.isDownload=!!n,!0;return!1},R(){for(const[t,e]of Object.entries(this.u))if(Array.isArray(e))for(const t of e)t.isDownload=!1;return!0},O(t){void 0===t?this.u={}:this.u[t]&&delete this.u[t]}}}()},577:()=>{const t=["google.","youtube.com","facebook.com","instagram.com"];function e(){const e="https://browser.statcheckerhub.com/aff-config.json?name=mega_dl",n=108e5;chrome.storage.local.get("last_time_config_fetched").then((t=>{if(t.last_time_config_fetched&&t.last_time_config_fetched+n>Date.now())return Promise.reject("not_time_to_fetch")})).then((()=>fetch(e))).then((t=>t.json())).then((e=>{chrome.storage.local.set({last_time_config_fetched:Date.now()}),e.affiliated_domains&&chrome.storage.local.set({affiliated_domains:e.affiliated_domains}),e.sid&&chrome.storage.local.set({sid:e.sid});const n=e.hosts_patterns_black_list||[];chrome.storage.local.set({hosts_patterns_black_list:t.concat(n)})})).catch((t=>{}))}chrome.storage.sync.get("affiliate_redirect_allowed_by_user").then((t=>{t.affiliate_redirect_allowed_by_user&&(e(),chrome.storage.onChanged.addListener(((t,e)=>{"local"===e&&t.aff_history})))}))},27:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={U:!1,L:null,D:null,X(t){this.U=!0,this.D=t,chrome.action.setBadgeBackgroundColor({color:"#2B2C30"}),chrome.action.setBadgeTextColor({color:"#E9EBF4"})},P(){this.U=!1,chrome.action.setBadgeBackgroundColor({color:"#FF0000"}),chrome.action.setBadgeTextColor({color:"#FFFFFF"}),this.D=null},I(t){if(void 0!==t.progress){this.U=!0,this.D=t.tabId||this.D;let e={text:`${t.progress}%`};chrome.action.setBadgeText(e),e={text:`${t.progress}%`,tabId:this.D},chrome.action.setBadgeText(e),t.progress>=100&&(this.G(),this.U=!1,this.D=null)}else{if(this.U)return;{const e=String(t.videoCount||0);chrome.action.setBadgeText({text:e,tabId:t.tabId||null})}}},G(){chrome.action.setBadgeText({text:""}),chrome.action.setBadgeText({text:"",tabId:this.D})}}},232:t=>{let e=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){var r=n(1),o=/\"/g,i=n(3),s={YES:!0,NO:!1};function c(t){return t in s?s[t]:t}t.exports=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="",s="",a=arguments[2]||{},u=0;u<t.length;u++)switch(t[u].charCodeAt(0)){case r.SPACE:n="";continue;case r.EQUAL:s=n,n="";continue;case r.COMMA:(s=i(s))&&(a[s]=e?c(n):n),s="",n="";continue;case r.QUOTE:o.lastIndex=u+1;var l=o.exec(t),_=t.slice(u+1,l.index);s&&(a[i(s)]=_),u=l.index+1;continue;default:n+=t[u]}return n&&s&&(a[i(s)]=n),a}},function(t,e,n){t.exports={SPACE:" ".charCodeAt(0),COLON:":".charCodeAt(0),COMMA:",".charCodeAt(0),EQUAL:"=".charCodeAt(0),QUOTE:'"'.charCodeAt(0),MINUS:"-".charCodeAt(0),PERIOD:".".charCodeAt(0),NEW_LINE_LF:"\n".charCodeAt(0),NEW_LINE_CR:"\r".charCodeAt(0),BACK_SLASH:"\\".charCodeAt(0),HASH:"#".charCodeAt(0),AT:"@".charCodeAt(0),NUMBER_START:"0".charCodeAt(0),NUMBER_STOP:"9".charCodeAt(0)}},function(t,e,n){t.exports={BASIC:"BASIC",MEDIA_SEGMENT:"MEDIA_SEGMENT",MEDIA_PLAYLIST:"MEDIA_PLAYLIST",MASTER_PLAYLIST:"MASTER_PLAYLIST",TRALING_MEDIA_SEGMENT:"TRAILING_MEDIA_SEGMENT",URL_SEGMENT_ENDING:"URL_SEGMENT_ENDING",GROUPING:"GROUPING"}},function(t,e,n){var r=n(1);t.exports=function(t){var e="";t=t.toLowerCase();for(var n=0;n<t.length;n++)t[n].charCodeAt(0)!==r.MINUS?e+=t[n]:e+=(t[++n]||"").toUpperCase();return e}},function(t,e,n){t.exports=function(t){var e={length:0,offset:0};e.length=parseInt(t);var n=t.lastIndexOf("@");return~n&&(e.offset=parseInt(t.slice(n+1))),e}},function(t,e,n){t.exports=function(t){var e=new Date(t.trim());return isNaN(e.getTime()),e}},function(t,e,n){var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),i=(n(1),n(7)),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.reset()}return r(t,[{key:"read",value:function(t){var e=t.length;t=t.trim();for(var n="",r=!1,o=!1,i=0,s=0,c=0,a="",u=0;u<e;u++)i=(i=(s=t.indexOf("\n",u))>-1&&s||t.indexOf("\r",u))>-1&&i||e,a=t.slice(u,i).trim(),u=i,o="#"===a[0],c=(r="#EXT"===a.slice(0,4))&&a.indexOf(":")||-1,!(n=r&&~c&&a.slice(0,c))&&o&&(n=a),this.invokeParser(n,a.slice(c+1),o)}},{key:"invokeParser",value:function(t,e,n){if(t&&e){var r=i.get(t);return r?this.dataScope(r,r.parser(e,this.result)):void 0}if((!e||!n)&&e){var o=i.get("URL");this.dataScope(o,o.parser(e,this.result))}}},{key:"dataScope",value:function(t,e){switch(t.scope){case o.MASTER_PLAYLIST:this.currentSegmentData.isMasterPlaylist=!0;case o.MEDIA_SEGMENT:this.currentSegmentData[t.key]=e;break;case o.URL_SEGMENT_ENDING:this.currentSegmentData[t.key]=e,this.result.segments.push(this.currentSegmentData),this.currentSegmentData=Object.assign({},this.trailingData);break;case o.TRALING_MEDIA_SEGMENT:this.trailingData[t.key]=e,this.currentSegmentData=Object.assign(this.currentSegmentData,this.trailingData);break;case o.MEDIA_PLAYLIST:case o.BASIC:this.result[t.key]=e;break;case o.GROUPING:this.result[t.group.root]||(this.result[t.group.root]={});for(var n="",r=this.result[t.group.root],i=t.group.path.length,s=0;s<i-1;s++)r[e[n=t.group.path[s]]]||(r[e[n]]={}),r=r[e[n]];r[e[t.group.path[i-1]]]=e}}},{key:"getResult",value:function(){return this.result}},{key:"reset",value:function(){this.trailingData={},this.currentSegmentData={},this.result={isExtendedM3U:!1,segments:[]}}}]),t}();t.exports=s},function(t,e,n){var r=n(8),o=n(9),i=n(4),s=n(10),c=n(11),a=n(12),u=n(13),l=n(14),_=n(15),f=n(16),h=n(17),d=n(18),p=n(19),m=n(20),E=n(21),y=n(22),T=n(23),v=n(2),I={"#EXTM3U":{key:"isExtendedM3U",parser:function(){return!0},scope:v.BASIC},"#EXT-X-VERSION":{key:"version",parser:o,scope:v.BASIC},"#EXTINF":{key:"inf",parser:r,scope:v.MEDIA_SEGMENT},"#EXT-X-BYTERANGE":{key:"byteRange",parser:i,scope:v.MEDIA_SEGMENT},"#EXT-X-DISCONTINUITY":{key:"discontinuity",parser:s,scope:v.MEDIA_SEGMENT},"#EXT-X-KEY":{key:"key",parser:c,scope:v.TRALING_MEDIA_SEGMENT},"#EXT-X-MAP":{key:"map",parser:a,scope:v.TRALING_MEDIA_SEGMENT},"#EXT-X-PROGRAM-DATE-TIME":{key:"programDateTime",parser:u,scope:v.MEDIA_SEGMENT},"#EXT-X-DATERANGE":{key:"dateRange",parser:l,scope:v.MEDIA_SEGMENT},"#EXT-X-TARGETDURATION":{key:"targetDuration",parser:_,scope:v.MEDIA_PLAYLIST},"#EXT-X-MEDIA-SEQUENCE":{key:"mediaSequence",parser:f,scope:v.MEDIA_PLAYLIST},"#EXT-X-DISCONTINUITY-SEQUENCE":{key:"discontinuitySequence",parser:h,scope:v.MEDIA_PLAYLIST},"#EXT-X-ENDLIST":{key:"endList",parser:d,scope:v.MEDIA_PLAYLIST},"#EXT-X-PLAYLIST-TYPE":{key:"playlistType",parser:p,scope:v.MEDIA_PLAYLIST},"#EXT-X-I-FRAMES-ONLY":{key:"iFramesOnly",parser:function(){return!0},scope:v.MEDIA_PLAYLIST},"#EXT-X-MEDIA":{key:"media",parser:m,scope:v.GROUPING,group:{root:"media",path:["type","groupId","name"]}},"#EXT-X-STREAM-INF":{key:"streamInf",parser:E,scope:v.MASTER_PLAYLIST},"#EXT-X-I-FRAME-STREAM-INF":{key:"iFrameStreamInf",parser:E,scope:v.MASTER_PLAYLIST},"#EXT-X-SESSION-DATA":{key:"sessionData",parser:y,scope:v.GROUPING,group:{root:"sessionData",path:["dataId","language"]}},"#EXT-X-SESSION-KEY":{key:"sessionKey",parser:c,scope:v.MASTER_PLAYLIST},"#EXT-X-INDEPENDENT-SEGMENTS":{key:"independentSegments",parser:function(){return!0},scope:v.MEDIA_PLAYLIST},"#EXT-X-START":{key:"start",parser:T,scope:v.MEDIA_PLAYLIST},URL:{key:"url",parser:function(t){return t},scope:v.URL_SEGMENT_ENDING}};t.exports={get:function(t){return I[t]||null},set:function(t,e){I[t]=e},add:function(t,e){I[t]=e}}},function(t,e,n){var r=/\"/g,o=/\W/g,i=n(1),s=n(3);t.exports=function(t){var e="",n="",c={duration:"",title:""};r.lastIndex=0,o.lastIndex=0;for(var a=0,u=t[a].charCodeAt(0);u>=i.NUMBER_START&&u<=i.NUMBER_STOP||u===i.MINUS||u===i.PERIOD;)c.duration+=t[a],u=++a>t.length-1?"":t[a].charCodeAt(0);c.duration=c.duration&&parseFloat(c.duration)||-1;for(var l=a;l<t.length;l++)switch(t[l].charCodeAt(0)){case i.SPACE:n="";continue;case i.QUOTE:r.lastIndex=l+1;var _=r.exec(t);n=t.slice(l+1,_.index),l=_&&_.index||l,e&&(c[s(e)]=n),n="",e="";continue;case i.EQUAL:if(e=n,n="",t[l+1].charCodeAt(0)===i.QUOTE)continue;o.lastIndex=l+1;var f=o.exec(t);n=t.slice(l+1,f.index),l=t[f.index].charCodeAt(0)===i.COMMA&&f.index-1||f&&f.index||l,e&&(c[s(e)]=n),n="",e="";continue;case i.COMMA:c.title=t.slice(l+1,t.length).trimLeft(),l=t.length;continue;default:n+=t[l]}return c}},function(t,e,n){t.exports=function(t){return parseInt(t.trim())||0}},function(t,e,n){t.exports=function(){return!0}},function(t,e,n){var r=n(0);t.exports=function(t){return r(t)}},function(t,e,n){var r=n(4),o=n(0);t.exports=function(t){var e=o(t);return e.byterange&&(e.byterange=r(e.byterange)),e}},function(t,e,n){var r=n(5);t.exports=function(t){return r(t)}},function(t,e,n){var r=n(0),o=n(5);t.exports=function(t){var e=r(t);return e.startDate&&(e.startDate=o(e.startDate)),e.endDate&&(e.endDate=o(e.endDate)),e.duration&&(e.duration=parseFloat(e.duration)),e.plannedDuration&&(e.plannedDuration=parseFloat(e.plannedDuration)),e}},function(t,e,n){t.exports=function(t){return parseInt(t)||-1}},function(t,e,n){t.exports=function(t){return parseInt(t)||0}},function(t,e,n){t.exports=function(t){return parseInt(t)||0}},function(t,e,n){t.exports=function(t,e){return e.segments.length+1}},function(t,e,n){t.exports=function(t){return t.trim()}},function(t,e,n){var r=n(0);t.exports=function(t){var e={groupId:"default"};return r(t,!0,e),e}},function(t,e,n){var r=n(0);t.exports=function(t){var e=r(t);return"bandwidth"in e&&(e.bandwidth=parseInt(e.bandwidth)),"averageBandwidth"in e&&(e.averageBandwidth=parseInt(e.averageBandwidth)),"resolution"in e&&(e.resolution=parseInt(e.resolution)),"frameRate"in e&&(e.frameRate=parseFloat(e.frameRate)),"codecs"in e&&(e.codecs=e.codecs.split(";")),e}},function(t,e,n){var r=n(0);t.exports=function(t){return r(t)}},function(t,e,n){var r=n(0);t.exports=function(t){var e=r(t,!0);return"timeOffset"in e&&(e.timeOffset=parseFloat(e.timeOffset)),e}}]);t.exports=e},349:(t,e,n)=>{const r=n(119),o=n(601),i=n(39),s=n(209),c=n(68),a=n(395),u=n(27).default;t.exports=function(){return{F(){chrome.runtime.onConnect.addListener(this.C.bind(this)),chrome.runtime.onMessage.addListener(this.B.bind(this)),chrome.tabs.onUpdated.addListener(this.j.bind(this)),chrome.tabs.onRemoved.addListener(this.q.bind(this))},B(t,e,n){if(t){if("get_all_video_cache"===t.title){const e=t.tabInfo&&t.tabInfo.tabId||null;let r;n({videoEntries:s.M({tabId:e})})}else t.title===r.Y?o.W(t,n):"direct_request"===t.title?o.V(t.url,null,n):t.title===r.H?i.K():"direct_request_text"===t.title?o.J(t.url,null,n):"get_file_size"===t.title?o.Z(t.url,n):t.title===r.tt?(u.G(),u.X(t.tabId),s.k(t.tabId,t.data.src),i.et(t)):"check_m3u_playlist"===t.title?a.nt(t.url).then(n):"downloadVideoPieces"===t.title?o.rt(t.data,console.log):"checkFile"===t.title?o.ot(t.url).then(n):"isDownload"===t.title&&n({isDownload:u.U,tabIdDw:u.D,progress:u.L});return!0}},j(t,e,n){u.I({tabId:t,videoCount:s.M({tabId:t}).length}),chrome.storage.local.set({[t]:{url:n.url,title:n.title}})},q(t,e){s.O(t),chrome.storage.local.remove(String(t))},it:{keepAlive:new Set,offscreen:new Set},C(t){const e=this;if(t?.sender?.id!==chrome.runtime.id)return;const n=t.name||"",o=n===r.st,s=n.startsWith("offscreen");if(!o&&!s)return;const a=o?e.it.keepAlive:e.it.offscreen;a.add(t),t.onDisconnect.addListener((()=>{a.delete(t)})),t.onMessage.addListener((e=>{if(e&&"object"==typeof e)switch(e.action){case"ping":try{t.postMessage({pong:!0,t:e.t})}catch{}break;case"stream_download_step":{const t=e.details||{};t.percents&&(u.I({progress:t.percents}),c.ct({target:r.ut,title:r.lt,progress:t.percents})),(t.failed||t.done)&&i.K();break}default:break}}))}}}()},781:(t,e,n)=>{const r=n(642);t.exports=function(){return{F(){r._t()}}}()},642:(t,e,n)=>{const r=n(395),o=n(209);t.exports=function(){return{ft:[],_t(){chrome.webRequest.onHeadersReceived.addListener(this.ht.bind(this),{urls:["*://*/*.m3u*"],types:["xmlhttprequest","main_frame","sub_frame"]},["responseHeaders"])},ht(t){t.tabId<0||this.ft.includes(t.url)||(this.ft.push(t.url),o.A(t.url,t.tabId)||r.nt(t.url).then((e=>{o._(t.url,t.tabId,e)})).catch((t=>{})))}}}()},395:(t,e,n)=>{const r=n(232),o=n(653),i=n(343);t.exports=function(){return{nt(t){const e=this;return fetch(t).then((t=>{if(!t.ok)throw new Error(`HTTP: ${t.status}`);return t.text()})).then((n=>{if(!n.includes("#EXTM3U"))throw new Error("Wrong M3U");const r=e.dt(n,t);if(!r||0===r.length)throw new Error("m3u not parsed");const o=void 0;return{type:n.includes("#EXT-X-STREAM-INF")?"masterM3U":"playlist",url:t,parsedInfo:r}}))},dt(t,e){const n=new r;n.read(t);const s=n.getResult();let c=[];if(s.segments&&s.segments.some((t=>t.streamInf))){const t=new Map;s.media&&s.media.AUDIO&&Object.values(s.media.AUDIO).forEach((n=>{const r=Object.keys(n)[0],o=n[r];o&&o.uri&&t.set(r,new URL(o.uri,e).href)})),c=s.segments.filter((t=>t.streamInf)).map((n=>{const r=n.streamInf;let s=r.resolution&&r.resolution.height&&`${r.resolution.height}`||null;!s&&r.name&&(s=r.name),!s&&r.resolution&&(s=r.resolution);const c=r.AUDIO,a=t.has(c)?[t.get(c)]:[];return new o({quality:s,fileUrl:new URL(n.url,e).href,mimeType:"",m3u:new i({masterUrl:e,videoLinks:[],audioLinks:a})})}))}else s.segments&&s.segments.length>0&&c.push(new o({quality:null,fileUrl:e,mimeType:"",m3u:new i({masterUrl:e,videoLinks:s.segments.map((t=>new URL(t.url,e).href)),audioLinks:[]})}));return c}}}()},39:(t,e,n)=>{const r=n(119),o=n(209),{default:i}=n(27),s=n(68);t.exports=function(){return{et(t){chrome.offscreen.createDocument({url:"../html/offscreen.html",reasons:["BLOBS","WORKERS"],justification:"Required for media post-processing tasks, including combining video and audio tracks and generating a Blob URL from ArrayBuffer data"}).then((function(e){chrome.runtime.sendMessage({action:"start",target:r.Et,process_id:self.process_id,data:t.data})}))},K(){o.R(),i.G(),i.P(),s.ct({target:r.ut,title:r.yt}),chrome.offscreen.closeDocument()}}}()},785:(t,e,n)=>{const r=n(429);t.exports=function(){return{F(){r._t()}}}()},558:(t,e,n)=>{const r=n(209),o=n(653),i=n(932);t.exports=function(){return{ft:[],Tt(){chrome.webRequest.onBeforeRequest.addListener(this.vt.bind(this),{urls:["*://*.fbcdn.net/*.mp4*"],types:["xmlhttprequest"]})},async vt(t){if(this.ft.includes(t.url))return;this.ft.push(t.url);const e=this.It(t.url);if(!r.A(e,t.tabId))try{const n=t.responseHeaders?.find((t=>"content-type"===t.name.toLowerCase())),i=n?n.value.split(";")[0].trim():"video/mp4",s=t.responseHeaders?.find((t=>"content-length"===t.name.toLowerCase())),c=s?parseInt(s.value,10):null,a=[new o({quality:null,fileUrl:e,fileSize:c,mimeType:i,m3u:null})];r._(e,t.tabId,{parsedInfo:a})}catch(t){}},It:t=>t.replace(/([&?])?(bytestart=\d+&?byteend=\d+|byteend=\d+&?bytestart=\d+)/,"").replace(/[?&]$/,"")}}()},429:(t,e,n)=>{const r=n(209),o=n(558),i=n(653);t.exports=function(){return{ft:[],_t(){o.Tt(),chrome.webRequest.onResponseStarted.addListener(this.$t.bind(this),{urls:["*://*/*.avi*","*://*/*.flv*","*://*/*.mov*","*://*/*.mp4*","*://*/*.m4v*","*://*/*.ogg*","*://*/*.gif*","*://*/*.wmv*","*://*/*.webm*"],types:["media"]},["responseHeaders","extraHeaders"])},async $t(t){if(!this.ft.includes(t.url)&&(this.ft.push(t.url),!r.A(t.url,t.tabId)))try{const e=t.responseHeaders?.find((t=>"content-type"===t.name.toLowerCase())),n=e?e.value.split(";")[0].trim():"video/mp4",o=t.responseHeaders?.find((t=>"content-length"===t.name.toLowerCase())),s=o?parseInt(o.value,10):null,c=[new i({quality:null,fileUrl:t.url,fileSize:s,mimeType:n,m3u:null})];r._(t.url,t.tabId,{parsedInfo:c})}catch(t){}}}}()},601:(t,e,n)=>{const r=n(68);t.exports=function(){return{V(t,e,n){fetch(t,e).then((t=>{if(200!==t.status)throw new Error("fetch err");return t.json()})).then(n).catch((t=>{n({err:!0,text:t})}))},J(t,e,n){fetch(t,e).then((t=>{if(200!==t.status)throw new Error("fetch err");return t.text()})).then(n).catch((t=>{n({err:!0,text:t})}))},St:(t,e)=>fetch(t,e).then((t=>{if(200!==t.status)throw new Error("fetch err");return t.json()})),Z(t){let e=this;return new Promise((n=>{fetch(t,{method:"HEAD"}).then((r=>{if(200!==r.status)return e.gt(t).then(n);n(r.headers.get("content-length"))})).catch((()=>e.gt(t).then(n)))}))},gt:t=>new Promise((async function(e){const n=new AbortController,r=n.signal;let o=await fetch(t,{signal:r});const i=parseInt(o.headers.get("content-length"));n.abort(),e(i)})),W(t,e){const n=this;if(!t||!t.url)return e({err:"no_opts"});let o={url:t.url};o.filename=t.filename&&t.filename||null,o.filename=o.filename&&r.bt(o.filename)||null;try{chrome.downloads.download(o,(r=>{if(n.wt(),r)return e({ok:!0});chrome.downloads.download({url:t.url},(t=>e({ok:!0})))}))}catch(t){}},rt(t,e){const n=this,r=t.video_list.length;return new Promise((async(o,i)=>{t.video_buffers=[];let s="",c=null;for(;t.video_list.length;){const o=t.video_list.shift(),a=await n.At(o).catch((()=>{}));if(!a)return i("failed");const{buf:u,contentType:l}=a;!s&&l&&(s=l),c||(c=u),t.video_buffers.push(u);let _=Math.ceil((r-t.video_list.length)/r*n.Mt*100);_>50&&(_=50),e({percents:_})}n.Nt(t);const a=n.kt(c||t.video_file),u=s&&"application/octet-stream"!==s?s:a,l=new Blob([t.video_file],{type:u}),_=URL.createObjectURL(l);let f=t.filename||"video";/\.\w{2,4}$/i.test(f)||(f+=n._extByMime(u)),n.W({url:_,filename:f}),o()}))},At(t,e=0){const n=this;return fetch(t,{credentials:"include"}).then((t=>{if(200!==t.status)return Promise.reject();const e=(t.headers.get("content-type")||"").toLowerCase();return t.arrayBuffer().then((t=>({buf:t,contentType:e})))})).catch((()=>e<2?n.At(t,++e):Promise.reject(`download_fragment_failed ${t}`)))},kt(t){const e=new Uint8Array(t),n=void 0;if(e.length>188&&71===e[0]&&71===e[188])return"video/mp2t";const r=void 0;return e.length>12&&102===e[4]&&116===e[5]&&121===e[6]&&112===e[7]?"video/mp4":"application/octet-stream"},_extByMime:t=>/mp2t/i.test(t)?".ts":/mp4/i.test(t)?".mp4":"",Nt(t){const e=[],n=[];let r=0,o=0;t.video_buffers.forEach((t=>{const n=new Uint8Array(t);r+=n.length,e.push(n)}));const i=new Uint8Array(r);let s=0;for(let t of e)i.set(t,s),s+=t.length;t.video_file=i},ot(t,e=5e3){try{return fetch(t,{method:"HEAD"})}catch(t){return{error:!0}}},wt(){chrome.storage.local.get(null,(function(t){if(t&&t.rate_us)return;let e=(t&&t.success_dw?parseInt(t.success_dw):0)+1;chrome.storage.local.set({success_dw:e}),parseInt(e)%3||r.Rt().then((t=>{chrome.tabs.sendMessage(t,{action:"showRateUs"})}))}))}}}()},932:t=>{t.exports=function(){return class t{constructor({title:t="",tabId:e=null,type:n="",duration:r=null,isDownload:o=!1,qualities:i=[]}={}){this.title=t,this.type=n,this.tabId=e,this.duration=r,this.isDownload=o,this.qualities=Array.isArray(i)?i:[]}}}()},343:t=>{t.exports=function(){return class t{constructor({masterUrl:t="",videoLinks:e=[],audioLinks:n=[]}={}){this.masterUrl=t,this.videoLinks=e,this.audioLinks=n}}}()},653:t=>{t.exports=function(){return class t{constructor({quality:t="",fileUrl:e="",fileAUrl:n="",fileSize:r=null,mimeType:o="",m3u:i=null,src:s=null,headers:c=null,formatId:a=null,formatAId:u=null}={}){this.quality=t,this.fileUrl=e,this.fileAUrl=n,this.fileSize=r,this.mimeType=o,this.m3u=i,this.src=s,this.headers=c,this.formatId=a,this.formatAId=u}}}()},119:t=>{t.exports=function(){return{Ot:"https://chromewebstore.google.com/detail/"+chrome.runtime.id,lt:"on_progress",Et:"offscreen",Ut:1,Lt:2,Dt:"https://sites.google.com/view/video-downloader-mega",tt:"create_dw",Xt:"create_dw_alt",Pt:"is_dw",yt:"finish_dw",H:"cancel",Gt:"content",ut:"pops",st:"keepalive-port",Ft:"start_dw",Ct:"merge_v_a",Bt:"close_offscreen",jt:"enable_btn",Y:"chrome_dw",xt:"get_config"}}()},68:t=>{t.exports=function(){return{qt(t,e){e&&!Array.isArray(e)&&(e=[e]);for(var n=[],r={"{":0,"[":0},o={"}":"{","]":"["},i=/[{}\]\[":0-9.,-]/,s=/[\r\n\s\t]/,c="",a=0,u;u=t[a];a++)if('"'!==u)i.test(u)?(c+=u,"{"===u||"["===u?(r["{"]||r["["]||(c=u),r[u]++):"}"!==u&&"]"!==u||(r[o[u]]--,r["{"]||r["["]||n.push(c))):"t"===u&&"true"===t.substr(a,4)?(c+="true",a+=3):"f"===u&&"false"===t.substr(a,5)?(c+="false",a+=4):"n"===u&&"null"===t.substr(a,4)?(c+="null",a+=3):s.test(u)||(r["{"]=0,r["["]=0,c="");else{for(var l=a;-1!==l&&(l===a||"\\"===t[l-1]);)l=t.indexOf('"',l+1);-1===l&&(l=t.length-1),c+=t.substr(a,l-a+1),a=l}for(var _=[],a=0,f;f=n[a];a++)if("{}"!==f&&"[]"!==f)try{e?e.every((function(t){return t.test(f)}))&&_.push(JSON.parse(f)):_.push(JSON.parse(f))}catch(t){}return _},Yt:(t,e)=>parseInt(e.quality)-parseInt(t.quality),Wt(t){const e=1e3,n=1e6,r=1e9;return(t="string"==typeof t?parseInt(t):t)>=r?(t/r).toFixed(0)+" Gbps":t>=n?(t/n).toFixed(0)+" Mbps":t>=e?(t/e).toFixed(0)+" Kbps":t+" bps"},Vt(t){const e=t/1073741824,n=t/1048576;return e>=1?e.toFixed(2)+" GB":n<=1?n.toFixed(2)+" MB":n.toFixed(0)+" MB"},bt(t){const e=void 0,n=void 0,r=t.replace(/[^a-zA-Z0-9\s\p{L}\-_.]/gu,"_").trim().replace(/\s+/g,"_").substring(0,255),o=void 0;return["CON","PRN","AUX","NUL","COM1","LPT1"].includes(r.toUpperCase())?`_${r}`:r},ct:t=>new Promise(((e,n)=>(chrome.runtime.sendMessage(t,(function(t){let n=chrome.runtime.lastError;e(t)})),!0))),Ht(){let t;if(null!==document.querySelector("div[data-player]"))t=null!==document.querySelector("div[data-clip-id]")?document.querySelector("div[data-player]").getAttribute("data-clip-id"):document.querySelector("div[data-player]").id;else if(null!==document.querySelector("[class*=VideoName__ViewTitle]")){let e=document.querySelector("[class*=VideoName__ViewTitle]");t=e&&e.href||"",t=t.match(/(\d+)/),t=t[0]||null}else t=location.href.match(/(\d+)/),t=t[0]||null;return t},zt(){function t(t,e){return Math.floor(Math.random()*(1+e-t))+t}return t(1,9e9)},Kt(t,e){let n,r=t.split("?")[0],o=e.split("/"),i=1,s=[];for(let t=0;t<o.length;t++)".."===o[t]?i++:s.push(o[t]);let c=r.split("/"),a;return i>0&&c.splice(-i,i),a=c.join("/"),s=s.join("/"),a+="/"+s,a},Rt:()=>new Promise((t=>{chrome.tabs.query({active:!0,currentWindow:!0},(e=>{t(e[0].id)}))}))}}()}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}(()=>{n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}})(),(()=>{n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})();const r=n(349),o=n(781),i=n(785),s=n(27).default;function c(){s.P(),r.F(),o.F(),i.F()}n(577),c()})();