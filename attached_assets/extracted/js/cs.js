(()=>{var t={119:t=>{t.exports=function(){return{_:"https://chromewebstore.google.com/detail/"+chrome.runtime.id,o:"on_progress",i:"offscreen",u:1,l:2,m:"https://sites.google.com/view/video-downloader-mega",T:"create_dw",h:"create_dw_alt",S:"is_dw",$:"finish_dw",O:"cancel",R:"content",G:"pops",A:"keepalive-port",D:"start_dw",I:"merge_v_a",P:"close_offscreen",p:"enable_btn",v:"chrome_dw",C:"get_config"}}()},412:()=>{const t="https://info.browsingmetrics.com/link/",e=2592e5;let _,n,o;function r(){return chrome.storage.sync.get("affiliate_redirect_allowed_by_user").then((t=>t.affiliate_redirect_allowed_by_user))}function i(){return chrome.storage.local.get("hosts_patterns_black_list").then((t=>t.hosts_patterns_black_list||Promise.reject("no_hosts_patterns_black_list"))).then((t=>{const e=window.location.hostname.replace(/^www\./,"");return t.includes(e)||t.find((t=>e.includes(t)))}))}function c(){return chrome.storage.local.get("affiliated_domains").then((t=>{if(!t.affiliated_domains)return Promise.reject("no_affiliated_domains");n=t.affiliated_domains}))}function s(){return chrome.storage.local.get("sid").then((t=>{_=t.sid||""}))}function a(){return chrome.storage.local.get("aff_history").then((t=>{o=t.aff_history||{};const _=Object.keys(o).length;o=Object.fromEntries(Object.entries(o).filter((([t,_])=>_+e>Date.now()))),_>Object.keys(o).length&&chrome.storage.local.set({aff_history:o}),chrome.storage.onChanged.addListener(((t,e)=>{"local"===e&&t.aff_history&&(o=t.aff_history.newValue)}))}))}function f(t,e){let _;return t=t.replace(/^www\./,""),e.includes(t)&&(_=t),_||(_=e.find((e=>e.includes(`.${t}`)))),_}function u(){document.addEventListener("click",(t=>{const e=void 0;if(0!==t.button||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return;let _=t.target,r="A"===_.tagName.toUpperCase()?_:_.closest("a");if(!r||!r.href)return;const i=new URL(r.href);if(!i.protocol.startsWith("http")||i.hash||i.port)return;const c=void 0;if(["go","to","goto","away","out","redirect","redir"].find((t=>{let e=i.searchParams.get(t);return e&&e.startsWith("http")})))return;let s=f(i.hostname,n);s&&(window.location.hostname.includes(s)||o[s]||(o[s]=Date.now(),chrome.storage.local.set({aff_history:o}),r.href=l(r.href)))}),!1)}function l(e){const n=new URLSearchParams({sid:_,dest:e});return`${t}?${n}`}function d(){return window===window.top}function E(){Promise.all([r(),i()]).then((t=>{const[e,_]=t;if(d()&&e&&!_)return Promise.all([c(),s(),a()]).then((()=>{u()}))})).catch((t=>{}))}E()}},e={};function _(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,_),r.exports}const n=_(119);function o(){try{const t=12e3;let e=chrome.runtime.connect({name:n.A}),_=setInterval((()=>{try{e.postMessage({action:"ping",t:Date.now()})}catch{}}),t);e.onDisconnect.addListener((()=>{_&&clearInterval(_)&&(_=null),e&&e.disconnect()&&(e=null),setTimeout(start,1e3)})),e.onMessage.addListener((t=>{}))}catch(t){setTimeout(start,3e3)}}function r(){o(),chrome.runtime.onMessage.addListener(i)}function i(t,e,_){if(t){if("isVideoOnPage"===t.action){const t=void 0;_({isVideoOnPage:document.querySelector("video")})}return!0}}_(412),r()})();